<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en-US' }}">
  <head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

{% seo %}
    <link rel="stylesheet" href="{{ "/assets/css/style.css?v=" | append: site.github.build_revision | relative_url }}">
    <link rel="stylesheet" href="{{ "/assets/css/custom.css?v=" | append: site.github.build_revision | relative_url }}">
    {% include head-custom.html %}
  </head>

  <body>
    <nav aria-label="Primary">
      <ul class="nav-main">
        {% assign all_pages = site.pages
          | where_exp: "p", "p.path contains '.md'"
          | sort: "order" %}

        {% assign titled_pages = all_pages
          | where_exp: "p", "p.title"
          | sort: "order" %}

        {% if page.title and page.title contains '.' %}
          {% assign active_top_title = page.title | split: '.' | first %}
        {% else %}
          {% assign active_top_title = page.title %}
        {% endif %}

        {% for p in titled_pages %}
          {% unless p.title contains '.' %}
            <li>
              <a
                href="{{ p.url | relative_url }}"
                {% if p.url == page.url %}
                  aria-current="page"
                {% elsif p.title == active_top_title %}
                  aria-current="location"
                {% endif %}
              >{{ p.title }}</a>
            </li>
          {% endunless %}
        {% endfor %}
      </ul>

      {% assign child_pages = titled_pages | where_exp: "p", "p.title contains '.'" %}
      {% assign has_active_children = false %}
      {% for c in child_pages %}
        {% assign c_top_title = c.title | split: '.' | first %}
        {% if c_top_title == active_top_title %}
          {% assign has_active_children = true %}
        {% endif %}
      {% endfor %}

      {% if has_active_children %}
        <ul class="nav-sub" aria-label="{{ active_top_title }} sub-pages">
          {% for c in child_pages %}
            {% assign c_top_title = c.title | split: '.' | first %}
            {% if c_top_title == active_top_title %}
              <li>
                <a
                  href="{{ c.url | relative_url }}"
                  {% if c.url == page.url %}aria-current="page"{% endif %}
                >{{ c.title | split: '.' | last }}</a>
              </li>
            {% endif %}
          {% endfor %}
        </ul>
      {% endif %}
    </nav>

    <div class="container-lg px-3 my-5 markdown-body">
      <main>
        {{ content }}
      </main>

      <footer>
        <div class="footer border-top border-gray-light mt-5 pt-3 text-right text-gray">
          Â© 2024-2026 Lars Rosenboom, licensed under <a href="/LICENSE.txt">CC-BY-NC-ND-4.0</a>
        </div>
      </footer>
    </div>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.1.0/anchor.min.js" integrity="sha256-lZaRhKri35AyJSypXXs4o6OPFTbTmUoltBbDCbdzegg=" crossorigin="anonymous"></script>
    <script>anchors.add();</script>
  </body>
</html>
